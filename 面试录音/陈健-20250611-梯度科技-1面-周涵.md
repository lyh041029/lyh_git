面试官：你先做一个自我介绍。

涵哥：面试官你好，我叫陈建，目前从事数据开发岗的话干了得有 4 年多的开发经验。嗯，主要的话开发语言就是Java、 Python 这些做得比较多，然后其他方面的话主要接触的就是一些数据开发的工作包，或者说像是 ETL 的抽取指标、逻辑加工，还有一些的话是做了一些像是这种数据报表渲染、 data report 这一块的工作都会有涉及到。然后其他方面的话，主要就是平台方面的经验，像阿里云、datawork、 GitLab 都是有过一些接触的。像是这种之前做过一些微软的一些业务，用过那个，他那个

面试官：稍等一下，你那边好像说话清楚，那是不是网络原因还是什么原因？

涵哥：你好，现在，现在我说话您可以听得清吗啊？

面试官：现在好点了，

涵哥：就是之前的话就是云平台的经验用得比较多，然后像Mac、computer、 ODPS 这些，然后都是有用过的。以上的话就是我的一个简单的自我介绍，谢谢面试官。

面试官：能说一下，就是你最近做了一个项目以及项目的情况，然后在这个项目里主要做了哪方面工作吗？

涵哥：嗯，这个项目的话其实主要就是做的一些数据开发类的工作做的比较多，像是这种就是报表类的开发，然后 SQL 的这些开发就做一些 ETL 的任务，还有一些是指标加工的一些逻辑都会有涉及，相当于是主要涉及到的就是根据业务的 PRD 文档去出一些效果，然后去满足业务方的一些需求。大多数情况是这样的，就是做一些指标逻辑的加工。

面试官：你那边是什么情况？感觉就是听着模模糊糊那种感觉

涵哥：还有什么没听清？

面试官：我说你那边是不是网络原因，那就是那种模模糊糊听不太清的那种感觉啊。 涵哥：那您稍等一下，我把这个画面关一下，您看一下。喂，你好，现在您可以听得清吗？可能是我这边网络有点波动，因为我们外面在刮大风

面试官： Hadoop 集群的话有做过

涵哥：做过，像这种线下集群的维护搭建，之前也有做过像 CDP 的那些都有接。

面试官：yml资源

涵哥：是这样的就是说yarn资源的话，我们会分为实时资源跟离线资源两个资源板块。然后，嗯，大多数情况下的话，其实就是说会分为就是两个队列来做，就是两个队列来区分是哪个，哪个是实时，哪个是离线这一块哦。如果说他的离线资源，因为会有一个动态的资源池，然后用的是那个容量调度器，如果说某一个资源就是抢占的比较多，它是有一个空余资源的一个释放的。

面试官：有遇到过这个

涵哥：是肯定有的，就是他任务资源抢占比较厉害，然后任务失败了，任务失败他就重新手动提交给他，提交到那个空余的队列里面去。就是我们比对，比如说我们 60% 的资源是离线的， 20% 是实时的，然后还有 20% 是空余的。一个队列就是为了留人，  
面试官：有一些容错任务提交策略

涵哥：任务提交策略，您指的是什么？我们用的是那个容量的那个调度器，您说的这个就是说优化资源参数是指的哪一块？就比如说它的那个 map 的数量，或者说实时那边的 task manager 的内存，是这些吗？

面试官：我觉得能优化的参数的话，

涵哥：比如说像实时任务的话，比如说它资源如果说比较紧张，可以适当地去调整它 task manager 的一个内存，就是先给它做一个 save point 给它保存，然后把一部分资源的话释放出来，就是挤出一部分的实时资源来，因为离线资源这边不太好做，说实话就是只跟他的 release 或者说 map 这些其实是不太好做的。

涵哥：比如说合并小文件，还有的话就是说，比如说实时往里面写的时候给他做这种限制写入。举个例子来说的话，就像是这种，比如说满 128 兆，我再给它做一个 low up，就是再给它回改回去，再给它就是说写进去相当于是就是不满 128 兆的文件不给它往里面做刷写，这样也能解决一部分小文件的问题。如果说已经产生了小文件，那就给它重写，重新做

涵哥：hive归档的话其实也会去做 ID 这个归档，包括说像 GVM 重用这些，所以这些的话基本上都是在参数里面去做的一个设置。

涵哥：Watermark 的水位线的话就是根据它的事件时间去做的一个指定，就是根据水位线，根据水位线的一个时间就包括不是水位线的时间，就是根据它事件发生的时间是做了一个水位线策略的一个宣传，相当于是。这怎么去说呢？就是说，比如说我根据他的事件时间，然后允许数据迟到多久，然让它去允许有一定的数据延迟，然后基本上是针对于那种乱序数据 for bound of all for bound of whatmark 的那个时间线的策略。

涵哥：这个判断失败的话有好几种可能，就是比如说这样，比如说像是这种这样去说，就是他如果说时间很短， check point 每次的时间都很短，他也有可能会导致他的这 check point 保存失败，所以一直在做 check point。的话是会出现这方面的一个问题的，这是第一个，第二个的话就是说他的那个元数据损害也可能会。就是它的文件损坏，也有可能出现健康的一个问题。精确一次的话就是 link 的精确一次， link 的精确一次的话就是他做了一个，嗯，它就是有一个精确一次的一个语义，就是一个一个词，就端到端的精准一次性，就是说 source 端它通过几个方面做的，

涵哥：第二个的话，比如说像是这种计算过程， compute 的过程，就是通过这种 compute 的过程的话，就是通过这种，像是那种 check point 或者说 save point 去保存数据，然后最后 sync 阶段的话就是通过就是怎么去看一下那个 point 或者说 check point 当中去保证。然后 sync 端的话就是 RPC 提交两阶段，提交通过事务跟通过事务去通过事务和一个预写日志的方式去保证数据的一个一致性。

涵哥：Spark 任务出现数据倾斜的话，先看是什么情况下引起的数据倾斜，就是说它是做分组的倾斜，还是说这种校验的倾斜？如果说是分组的倾斜，可以给它做打散，给它拼随机的这种尾列，或者说随机数、随机的 key 值可以去，都可以去做保证。然后像是这种 join 的信息的话，那就是说可以通过 map join 或者说的 batcars 方式把数据相当于是加载到内存当中去，然后再给他做两个阶段的这种聚合，这都可以。

面试官：也可以是使用 Maxwell 模型。 PDC 动作完成后。

涵哥：好，您可以再说一遍吗？我没有听得清。

面试官：在那个使用 SVN 的活动中。

涵哥：binlog 数据不丢失的话，那么我们的几个方面，第一个就是说针对于它数，针对于就开启它的那个前置 lo mode 的那个配置文件，那个配置。然后的话就是说可以从头开始消费，然后保存偏移量，然后比如说从 binlog 当中的某一个偏移量开始做保存，这样的话也可以保证就是就算数据 down 掉了，任务 down 掉了，从之前的这个 CK 当中去做恢复，这都没有问题。

涵哥：同步方案的话就是刚刚我跟您说到的就是它有一个配置，就是我想一下这个配置的名称，就是在它的那个 CPC 的 source 里面有一个，那个就是一个 busy 的那个配置，  busy 的配置的话就是把那个有一个参数，就是应该是change 那个参数给它拆下来，它可以去保证它的这个数据上游的 schema 的信息发生变动后，下游不报错。如果说不开这个配置的话，它其实就那个他这个任务就直接报错了，就是改表结构的这种情况下。

涵哥：然后是这样的，就之前的话用 CK 的主要原因就是一些历史遗留的数据问题放到 CK 里面了，然后就没有再去动，然后现在的话其实这部分的数据已经改掉了DWS，包括说 ADS 的数据现在都是在云上面，在 maxcompute 里面。最后的层级的话就是报表端用的是一个底表的数据知识啊。

涵哥：字段类型不兼容，全都转成varchar，或者说全部转成string，就是在数据同步的时候是用日期格式或者说那种小数位就很长的这种decimal， 这种全都转出私训的处理，然后下游按情况看是否要给它转成其他的数据类型，就是数据同步的时候尽量转成私训去做，这样的话比较方便。

涵哥： Doris 的话有几个点，第一个就是它的这些索引键，索引的这种索引的设置可以去做一些调整，比如说我给他做一些前缀索引，或者说做一些那种根据他的情况，就比如说如果说他是做分词做得多，那可以用这种基于倒排的索引，他查文档他查得比较快哦。

如果说是这种是否的基于这种位图来做，就 datamap 也可以就是基于索引去做一个更新，像其他的这种普通表的话，可以给它添加这种前缀索引就是加快查询速度嘛。然后就是explain，看它的执行计划，这些东西就是去看它的一个具体扫了多少分区，命中了哪些索引，走了哪个 scan 的模式，然后去做一个确定。

涵哥：没有用过CEP，确实没用过，就是那个模式匹配。就是听过，也看过它的相关文档，但是确实没有用过。这个没有在生产当中用过，我知道它是基于 python去做的，那个模是匹配，就比如说什么至少三次这种的。

涵哥：HDFS 的话其实就是分为几个点，Namenode，然后Datanode。包括说像是这种它高可用的有一个 Juniper node，就是做通信的。还有一个的话是那个历史服务器 serverdownnamenode 就存的就是它的一个元数据或者说索引，然后 data NODE 存的是它的一个实际的这种数据，然后 serverdownnamenode  主要是辅助联络的，做一些资源管理，它里面的话应该是两个文件去做的一个资源管理，但是它本身它也不参与namenode的。然后还有一个的话就是高可用的一个unit，还叫 job 的那个server，主要就是做高可用的那个心跳检测的通信的。

面试官：读写流程介绍一下  
涵哥：读写流程的话，就是一个客户端发起一个请求 name node，然后请求 name node，之后 name node 会检查这个客户端发过来的这个请求是否拥有可读写的权限。如果说没有可读写的权限的话，直接返回error，然后抛出 ask 的异常，就是权限异常。如果说有权限的话，那就是他去各个 data NODE 里面去，他先去查索引，查完之后去决定 NODE 里面去找到这个数据之后返回一个 pipeline 的数据管道，然后把数据按照包的方式，就是 packet 的方式进行发送。就是每一批发送完了都会有一个 call back，最后的话把多个文件合并成一个文件，再对外 output 出去啊。

涵哥：您说什么没听清领导

面试官：yarn的基本架构

涵哥：基本沟通yarn的基本架构的话分为几个，就是首先有一个 resource manager， Yan 的有一个 resource manager，还有一个是 application master。然后再往下的话就是一个 nodemanager。首先说 resource manager， resource manager 它就是一个资源管理器，它分，它是有分配资源的一个系统内系统资源的跟他的这个调度器是队列上，然后他就是负责接收一个具体的请求，比如说 Flink 的一个任务， Flink 的请求源上传一个，就是生成一个集群做，然后资源上的这种启动，然后包括说启动监控，然后下面的话就是一个 node manage， node manage 是各个节点的管理器，就是它就是负责节点上的一些资源的管理。CPU 内存这些它管理容器的生命周期，然后容器的话就是一个卡片，每个容器比如说它可以指定它的一个容器的资源使用量，比如说2C、 4G 这种的就是它的一个最小的分配单元。还有一个的话是 API master， API master 是基于应用程序的，就是申请资源，然后把资源分配给它的。

那我们今天面试就到这里。